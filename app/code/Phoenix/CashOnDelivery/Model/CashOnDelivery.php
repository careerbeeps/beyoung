<?php
/**
 * Phoenix Cash on Delivery module for Magento 2
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 *
 * @category   Mage
 * @package    Phoenix_CashOnDelivery
 * @copyright  Copyright (c) 2017 Phoenix Media GmbH (http://www.phoenix-media.eu)
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */

namespace Phoenix\CashOnDelivery\Model;

use Phoenix\CashOnDelivery\Model\Ui\ConfigProvider;

class CashOnDelivery extends \Magento\Payment\Model\Method\AbstractMethod
{
    protected $_code = ConfigProvider::CODE;

    protected $_formBlockType = 'Phoenix\CashOnDelivery\Block\Form';

    protected $_infoBlockType = 'Phoenix\CashOnDelivery\Block\Info';

    protected $_isOffline = true;

    protected $_canAuthorize = true;

    protected $_canCapture = true;

    protected $_canCapturePartial = true;

    public function getCustomText()
    {
        $customText = $this->getConfigData('customtext');

        return $customText;
    }

    /**
     * {@inheritdoc}
     */
    public function isAvailable(\Magento\Quote\Api\Data\CartInterface $quote = null)
    {
        $available = parent::isAvailable($quote);

        $disallowSpecificShippingMethods = $this->disallowSpecificShippingMethods();

        if (!$disallowSpecificShippingMethods) {
			$objectManager = \Magento\Framework\App\ObjectManager::getInstance();
		$shippingaddressCollection = $objectManager->get("\Magento\Checkout\Model\Session")->getQuote()->getShippingAddress()->getData();
		$allpostcodenotforcod = '688001,688002,688003,688004,688006,688007,688008,688009,688011,688012,688013,688521,688534,688582,689511,689622,689623,689624,690101,690102,690103,690104,690105,690106,690108,690110,690502,690503,690505,690508,690513,690514,690516,690558,690572,688010,688542,683103,683564,744101,744102,744103,744104,683586,683591,683592,722222,673013,673024,673025,673026,673031,673037,670015,670016,670565,670597,442701,442901,686107,686108,682000,682014,682222,683109,734301,682001,682002,682003,682004,682005,682006,682007,682009,682011,682012,682013,682015,682016,682017,682018,682019,682020,682021,682022,682023,682024,682025,682026,682028,682029,682030,682031,682032,682033,682034,682035,682036,682037,682040,682042,682303,682304,682306,682308,682310,682504,682506,682507,683101,683102,683104,683105,683106,683108,683501,683542,683543,683544,683556,683561,683562,683572,683573,683574,683576,683577,683585,683589,686661,686666,686668,686669,686670,686673,685585,670001,670002,670003,670004,670005,670006,670007,670008,670009,670010,670011,670012,670013,670014,670017,670018,670102,670103,670561,670562,670563,670594,701111,691001,691002,691004,691005,691006,691007,691008,691009,691010,691011,691012,691013,691014,691016,691019,691020,691021,691301,691504,691571,691574,691577,691581,691602,691542,686001,686002,686003,686004,686006,686007,686009,686010,686011,686015,686018,686101,686102,686103,686104,686105,686106,686573,686574,686578,686584,686632,686038,686039,673001,673002,673003,673004,673005,673006,673007,673008,673009,673010,673011,673012,673014,673015,673016,673017,673018,673019,673020,673021,673027,673028,673029,673032,673570,673601,673631,673632,673633,673634,673635,673638,673647,676101,676121,676503,676505,676519,679322,690109,690552,690570,741201,741302,741402,741404,741502,805110,686589,686597,678001,678002,678003,678004,678005,678006,678007,678008,678009,678010,678011,678012,678013,678014,678621,678623,689503,413105,686619,686680,691017,691605,694582,416312,785690,695001,695002,695003,695004,695005,695006,695007,695008,695009,695010,695011,695012,695013,695014,695015,695016,695017,695018,695019,695021,695022,695023,695024,695025,695029,695030,695032,695033,695034,695035,695036,695038,695040,695043,695141,695145,695564,695581,695583,695031,695037,695039,695041,695044,695049,680001,680002,680003,680004,680005,680006,680007,680008,680009,680011,680020,680021,680022,680026,680027,680125,680306,680307,680308,680018,700118,700120,700121,700124,700125,700126,700128,700129,700130,700134,700135,743122,743123,743124,743127,743128,743129,743133,743134,743135,743136,743144,743145,743165,743166,743194,743233,743235,743263,743272,743273,743287,743289,743291,743401,743411,743426,743428,743429,743437,743445,743704,700138,700139,700144,700146,700147,700148,700151,743503,504103,504201,504203,504205,504215,504231,504251,504293,504296,504307,504311,283201,283202,413201,413709,413713,414113,422605,423109,423601,382120,382150,796007,796012,305008,305022,305901,688005,688014,688522,688523,688524,688525,688527,688531,688537,688539,689109,690548,202001,202002,301001,301027,301030,321605,321606,321607,133005,133007,133201,224123,365601,388306,388430,388470,388540,515001,515002,515003,515005,515110,515133,515134,515231,515301,515401,515408,515411,515511,515591,515661,515761,515775,515812,515865,515871,759100,759101,759123,759132,612904,621651,621704,621705,621707,621710,621713,621730,621801,621803,621804,621806,713364,473331,431150,431201,587101,756025,756056,385001,385520,385535,210001,562111,713512,722101,722102,722122,722132,722140,722141,722158,722183,722202,722203,722205,722207,327001,225001,225003,325202,325205,712410,713104,713124,713125,713126,713127,713128,713130,713140,713144,713146,713147,713148,713149,713151,713152,713167,713315,713322,713331,713333,713334,713336,713338,713339,713342,713343,713347,713357,713358,713359,713365,713369,713371,713378,713380,713384,713385,713403,713404,713406,713407,713408,713409,713421,713422,713423,713424,713502,768102,768103,768104,344022,148100,151103,431517,583201,460001,460002,756100,756101,756135,756181,441904,441905,441912,311011,311021,301017,462031,586101,246701,246761,331801,331803,331811,334021,334022,334023,334201,334202,334302,334305,334402,334403,334601,334603,334604,334801,334803,334804,495005,495001,495004,495006,495009,495223,731101,731102,731103,731121,731123,731127,731132,731201,731204,731216,731219,731220,731224,731233,731234,731235,731236,731237,731243,731303,783385,243601,190005,190007,190014,190021,323001,788009,788805,845438,571111,202412,442501,442502,442902,442908,442917,480001,480106,577547,577501,577535,517112,517129,517214,517234,517236,517247,517299,517325,517370,517408,517424,517425,517504,517583,517590,517592,312001,312601,323305,331001,331021,331022,331023,331029,331302,331303,331304,331403,331411,331501,331502,331507,331517,331802,638103,641101,641112,641302,641305,641665,641667,641697,642102,642107,642111,642112,642122,642123,642126,642127,642128,642132,642133,642134,642154,642201,642204,642205,606003,606103,606105,606106,606108,606110,606111,606302,606304,607102,607104,607108,607302,607401,608102,608301,608302,608303,608305,608601,608602,608702,516101,516104,516115,516172,516193,516227,516269,516289,516309,516329,516380,516390,516434,754021,754221,389140,389151,389380,574199,574239,734421,734423,734426,734434,577601,248179,249201,249203,493773,635202,635305,636903,636904,636905,636906,328001,424001,424002,424004,424005,786610,733123,733129,733130,733134,733101,733102,733103,733124,624101,624201,624202,624204,624208,624210,624211,624215,624219,624220,624304,624306,624308,624401,624403,624610,624613,624615,624616,624617,624618,624620,624621,624622,624701,624702,624703,624704,624705,624708,624709,624710,624711,624712,624801,624802,642113,314001,314025,314403,680667,682008,682010,682027,682038,682039,682041,682301,682302,682305,682309,682311,682312,682313,682314,682315,682316,682501,682502,682503,682505,683110,683111,683112,683502,683503,683511,683512,683513,683514,683515,683516,683517,683518,683519,683520,683521,683522,683541,683545,683546,683563,683565,683571,683575,683578,683579,683580,683581,686664,686665,686667,686672,686691,638054,638055,638057,638101,638104,638106,638109,638110,638115,638116,638153,638154,638313,638314,638315,638451,638454,638455,638457,638458,638459,638460,638461,638501,638502,638505,638656,638661,638672,638673,638702,638706,206001,224001,151203,151204,209625,283203,283204,142047,142050,582101,335002,335022,335023,335027,335041,335051,335073,335707,335804,737102,203207,824231,201102,245304,815301,815316,403102,403103,403105,403403,403506,403512,403524,403702,403703,403704,403705,403706,403723,507130,533102,533107,533124,533212,533214,533216,533233,533240,533241,533242,533251,533253,533260,533286,533287,533288,533341,533342,533344,533401,533406,533428,533429,533432,533435,533436,533440,533445,534112,534122,534123,534198,534199,534235,534238,534245,534260,534280,534281,534301,534312,534313,534315,534320,534328,534341,534350,534425,534426,534449,534460,534462,441601,441612,441614,441902,273001,273002,273003,273004,273005,273006,273008,273009,273010,273012,273013,273014,273015,585105,585228,585229,835207,473001,473111,522020,522236,522265,522313,522413,522414,522415,522426,522438,522503,522647,143505,143506,143521,143531,122022,122503,781002,335063,335504,335512,335513,335526,335802,335803,573102,581106,581110,581115,581118,825301,712104,712123,712125,712148,712149,712221,712310,712401,712403,712407,712502,712503,712601,712613,712702,461001,461005,461111,144205,711303,711306,711310,711312,711313,711316,711322,711401,685501,685509,685535,685553,795003,795008,754142,754143,754145,303001,303007,303802,345021,425109,425201,343001,343029,222001,222002,284001,284002,284003,284135,331027,333001,333026,333031,333042,342301,785704,362002,362003,362004,362225,362265,362266,362268,362269,244221,244235,501505,370465,173002,603001,603101,603104,603109,603112,603201,603301,603303,603306,603308,603312,603319,603406,631551,631552,631601,631605,631606,176001,176031,176047,176057,176061,176215,176219,209725,670101,670104,670105,670106,670107,670141,670301,670307,670592,670643,670691,670701,670703,209311,209203,629153,629154,629157,629158,629159,629161,629162,629167,629168,629169,629171,629172,629173,629174,629175,629176,629177,629180,629193,629201,629203,629252,629301,629302,629401,629402,629403,629501,629601,629802,629804,629851,629852,629901,141310,609603,609607,322230,505122,505172,505184,505209,505404,505425,505460,505467,505468,788803,621311,639102,639104,639105,639106,639107,639111,639113,639116,639117,639118,639136,639201,639202,639205,639206,671121,671123,671124,671314,671315,671317,671318,671323,671531,671541,483501,483504,507002,507103,507113,507114,507116,507117,507118,507119,507120,507121,507122,507123,507124,507125,507126,507128,507129,507133,507134,507135,507136,507137,507138,507140,507157,507158,507159,507160,507161,507163,507164,507165,507166,507167,507168,507169,507170,507182,507183,507201,507202,507203,507204,507208,507209,507210,507211,507301,507302,507303,507304,507305,507306,507316,507318,387130,387345,387355,387370,387380,387620,388220,403210,752050,508206,571213,571234,561228,563114,563115,563120,563130,416112,416113,416114,416116,416144,416202,416205,416212,416216,689695,690518,690519,690520,690521,690523,690524,690526,691003,691015,691302,691303,691304,691305,691306,691307,691308,691309,691310,691311,691312,691319,691322,691331,691332,691333,691334,691500,691501,691502,691503,691505,691506,691507,691508,691509,691510,691511,691512,691515,691516,691520,691521,691522,691531,691532,691533,691534,691535,691536,691537,691538,691540,691541,691543,691557,691559,691560,691566,691572,691573,691576,691578,691579,691582,691583,691584,691585,691589,691590,691601,583227,495450,495452,495454,495677,495678,495682,495683,495684,326519,686005,686008,686012,686013,686016,686019,686121,686507,686575,686631,686633,627810,673101,673303,673502,521101,521104,521120,521121,521157,521178,521180,521215,521230,521235,521286,521324,521328,521333,521366,175125,175131,612107,612108,518101,518112,518123,518124,518134,518221,518222,518313,518345,518380,518395,518401,518422,518464,518510,518533,518553,518599,132118,132119,132135,413512,413517,792110,141120,625102,625103,625105,625108,625109,625110,625218,625221,625301,625501,625503,625703,509102,509103,509104,509127,509208,509209,509210,509301,509321,509324,509375,509381,384170,384315,205001,676102,676107,676122,676309,676311,676312,676319,676501,676504,676506,676507,676509,676522,676541,676542,676553,676561,676562,679321,679324,679326,679333,679334,679338,679571,679572,679576,679577,679581,679587,679591,732123,732124,732128,732139,732141,732142,732201,732206,732215,175001,175023,458001,458002,571401,571403,571423,571438,502110,502286,502291,502302,502313,250005,250105,384206,721134,721137,721139,721151,721152,721154,721169,721171,721401,721422,721423,721427,721428,721429,721430,721431,721432,721433,721434,721439,721441,721444,721447,721448,721449,721452,721453,721455,721458,721461,721502,721601,721602,721603,721628,721629,721631,721632,721633,721635,721636,721641,721645,721648,721650,721651,721654,721657,721658,721659,721668,721670,721101,721102,721124,721126,721127,721130,721132,721136,721143,721145,721147,721153,721201,721211,721212,721222,721232,721303,721424,721425,721426,721436,721445,721467,721507,721516,721663,231001,140103,140507,160060,244302,151202,152107,811201,811202,811214,742101,742102,742103,742123,742133,742134,742135,742137,742147,742148,742149,742187,742188,742202,742212,742225,742236,251001,251002,251003,571124,741102,741103,741121,741126,741156,741222,741234,741235,741245,741246,741247,741250,741251,782001,782435,609102,609103,609105,609110,609111,609112,609201,609202,609301,609307,609309,609311,609314,609401,609404,609702,609703,609801,609803,609805,609806,609810,610201,610207,610211,611002,611104,611105,611109,611110,612201,612203,614707,614711,614712,614714,614806,614808,614809,614810,341001,341021,341024,341025,341301,341501,341505,341508,341509,341510,341511,441001,441104,441105,441106,441107,441110,441204,441401,263140,508114,508116,508204,508207,508248,508252,508277,636202,636301,637002,637003,637013,637015,637017,637019,637020,637104,637201,637203,637204,637205,637206,637207,637210,637212,637213,637214,637401,637402,637403,637404,637405,637406,637408,637409,637410,637412,637503,638181,431803,393115,422201,422206,422207,422402,423203,396403,396406,396409,396412,396415,396418,396430,396433,396436,396439,396440,396463,396466,396469,396472,396475,396530,396540,396560,396570,396580,396590,144505,144514,458441,458470,524132,524224,524226,524228,524306,524308,524321,524322,524341,524344,524401,685121,643002,643003,643005,643205,643207,643211,643212,643213,643214,643217,643218,643221,643223,643225,643226,643239,643240,643241,643242,450001,450331,451001,503122,503175,503212,503224,503245,503306,503307,503310,413501,678101,678503,678506,678507,678508,678555,678582,678583,678592,678601,678624,678631,678633,678701,679101,679121,679123,679303,679307,679503,678707,683553,306001,306104,306115,306116,306304,306401,306902,389001,389230,389260,384151,384265,689101,689102,689103,689104,689106,689107,689108,689110,689111,689672,690522,691523,691524,691525,691526,691530,691551,691552,691553,691554,691555,691556,140506,140601,147201,801109,249304,621103,621108,621109,621115,621116,621118,621133,621212,621220,621708,621717,262001,523101,523105,523108,523156,523157,523167,523184,523201,523212,523230,523240,523247,523253,523303,523327,523333,523357,523373,613301,614616,614617,614618,614622,614624,621316,622101,622102,622103,622104,622201,622202,622203,622301,622302,622303,622304,622408,622411,622501,622502,622503,622504,622505,622506,622507,622515,410504,410515,411111,412108,412115,412212,412215,413106,413114,723101,723121,723131,723133,723146,723157,723202,229010,584101,584123,584128,496001,493118,493331,360026,360311,360370,360375,363621,363642,491441,313324,623120,623211,623404,623409,623501,623502,623504,623512,623513,623514,623517,623518,623519,623521,623522,623523,623524,623526,623527,623528,623529,623531,623534,623536,623560,623603,623703,623704,623705,623708,623712,623806,244901,835301,457001,415202,415603,415605,415606,415611,415612,415639,415709,415712,415722,415801,416702,765001,486001,486002,486003,140101,140124,140413,383235,383255,383430,470001,636102,636104,636105,636107,636108,636109,636110,636111,636112,636113,636115,636116,636117,636119,636121,636122,636140,636141,636203,636304,636305,636306,636403,636404,636453,636454,636455,636457,636501,636502,636503,636601,636602,637407,768105,416302,416303,416304,416311,416405,416414,148001,148021,148022,148024,148025,148028,221301,221303,221304,221314,841301,412803,412806,415012,415105,415106,415108,415109,415110,415205,415206,415501,415502,415505,415506,415508,415509,415510,415511,415512,415514,415515,415519,415522,485001,485002,485003,485004,322001,322201,466001,833220,171006,171007,577201,577202,577203,577204,577302,577401,577427,577432,473551,473638,785670,416613,832107,173030,307026,125076,125201,623701,841226,174101,413001,413002,413003,413004,413005,413006,413007,413101,413107,413108,413109,413112,413113,413118,413255,413304,413401,231222,131029,532127,532168,532185,532195,532201,532213,532216,532242,532243,532263,532284,532312,532322,532405,532409,532421,532427,532440,532455,532456,532459,532460,190001,190002,190003,190004,190006,190008,190009,190010,190011,190012,190015,190017,227817,228001,769010,770001,770017,363030,143416,401401,401402,401403,401405,401504,401601,401606,401607,401608,401609,401610,401701,401702,401703,421102,421103,421204,421603,421605,609802,609807,612101,612102,612103,612104,612204,612301,612502,612503,612504,612703,613103,613104,613201,613204,613303,613501,613502,613504,614201,614203,614204,614206,614207,614210,614211,614301,614302,614303,614601,614602,614612,614614,614625,614628,614701,614723,614802,614804,614901,614902,614903,614906,625518,625602,695020,695026,695027,695042,695099,695101,695121,695306,695521,695523,695524,695527,695547,695582,695586,695601,679105,679106,679531,679532,679561,679562,679563,679564,680010,680012,680013,680014,680121,680122,680302,680303,680304,680305,680309,680310,680311,680312,680317,680501,680502,680503,680504,680505,680506,680507,680508,680509,680510,680511,680512,680513,680514,680515,680516,680517,680518,680519,680520,680521,680522,680523,680524,680541,680542,680543,680544,680545,680546,680551,680552,680553,680555,680561,680562,680563,680564,680565,680566,680567,680568,680569,680570,680571,680581,680582,680583,680584,680585,680586,680587,680588,680589,680590,680591,680594,680596,680601,680602,680604,680611,680612,680613,680614,680615,680616,680617,680618,680619,680620,680623,680631,680641,680642,680651,680652,680653,680654,680655,680656,680661,680662,680663,680664,680665,680666,680668,680669,680670,680671,680681,680682,680683,680684,680685,680686,680687,680688,680689,680691,680697,680699,680701,680702,680703,680711,680712,680721,680722,680724,680731,680732,680733,680734,680736,680751,620101,620102,621001,621002,621003,621005,621006,621007,621008,621010,621011,621012,621014,621104,621111,621112,621203,621205,621206,621207,621208,621209,621210,621211,621213,621214,621215,621216,621218,621305,621306,621307,621308,621310,621314,621315,621652,621653,621702,621703,621706,621711,621712,621715,639112,627102,627103,627105,627106,627107,627109,627110,627111,627115,627116,627117,627152,627201,627202,627352,627357,627358,627417,627451,627453,627601,627604,627719,627753,627754,627757,627760,627802,627803,627804,627805,627806,627807,627811,627812,627818,627853,627855,627856,627857,627858,627859,627861,627951,601101,601102,601103,601202,601205,602001,602002,602003,602023,602024,602025,602026,631203,631205,631207,631210,631213,604401,604402,604403,604405,604409,604501,606611,606701,606702,606703,606704,606705,606707,606709,606751,606753,606754,606801,606802,606803,606807,606903,606905,606906,631702,632311,632313,632315,632316,632512,609403,609501,609504,610001,610102,610109,610206,612601,612604,612605,612610,612701,612801,612802,614016,614101,614102,614103,614208,614403,614404,614704,614708,614713,614715,614716,680657,799009,799010,572130,572132,572201,572202,627758,628105,628151,628152,628201,628202,628203,628204,628206,628207,628210,628211,628213,628251,628252,628401,628402,628601,628617,628621,628623,628704,628751,628752,628753,628801,628802,313203,313802,182101,574106,574115,574116,574117,574118,576113,576114,576201,576210,576213,576218,576225,581314,581320,581402,249193,221104,221105,221109,221306,221311,362267,631001,631002,631004,631005,631051,631052,631101,631102,631151,632055,632058,632059,632101,632102,632103,632104,632105,632106,632201,632202,632203,632209,632319,632404,632405,632501,632508,632509,632515,632516,632517,632519,632531,632601,632603,635804,635805,635808,635809,635811,635814,520000,521103,530000,604151,604152,604204,604205,604206,604207,604301,604302,604304,604306,604307,605652,605702,605754,606107,606201,606203,606206,606207,606208,606401,606402,607107,607204,626004,626005,626105,626109,626110,626111,626112,626113,626119,626121,626126,626128,626129,626131,626132,626133,626138,626144,626149,626201,626203,626204,626205,530031,530040,531024,531027,531036,531055,531081,531105,531111,531113,531116,535145,535101,535128,535183,535270,535501,535524,535547,535558,535591,506101,506132,506143,506163,506164,506167,506343,670645,673121,673122,673579,673592,585223,445003,190016,303313,182220,283110,283112,688506,689124,689509,689572,690533,263645,263653,301402,301404,301408,301411,224190,192122,759124,484334,473446,206121,206122,276129,263642,250101,250609,250611,277201,277303,224120,225401,193103,193121,193401,193404,193501,193502,193504,325216,325218,325219,325221,243201,344031,344033,344034,344044,344704,451447,494226,460447,460551,460661,756168,321022,321203,311301,311404,311602,246725,246733,246745,246747,246762,246763,174021,174029,174030,174031,829301,243639,243722,243727,243751,203131,203132,203205,203390,203391,203392,203393,203394,203395,203405,203408,203412,323603,176302,176310,176315,176318,246401,246443,232104,232110,825404,471606,480334,480337,480338,480441,480551,210205,323303,323304,323306,323307,331701,754004,754007,754009,754030,754031,754209,494553,321608,248123,248124,814114,455116,455223,455336,454116,454449,454552,328025,783371,786621,182204,182222,491331,491771,450116,832106,686671,686693,207001,207123,207242,207244,207247,207302,209601,212659,205262,761201,761213,335062,335701,335704,761012,761111,761118,203135,203141,245205,245301,233302,275202,783123,814154,271308,273201,273212,210502,176110,241204,461223,461228,461441,461771,461881,461990,685508,685552,685561,685571,685589,685606,685609,795010,795002,453115,453551,482021,483110,303002,303008,303103,303105,303109,303301,303328,303329,303338,303712,303801,755004,755009,755028,307029,343022,343041,735207,184120,815354,223101,457661,457773,457779,457887,284202,284301,284305,768211,333704,342602,342603,342605,244231,244241,782403,762103,176023,176051,176201,176401,176402,177101,177108,494776,209726,209727,670503,670571,670602,670633,209206,209302,209306,321611,322241,670511,671313,671533,483880,754222,758002,758031,262902,752023,752057,752066,172030,825418,690525,497335,325208,686144,686512,686513,686515,686576,686582,686604,686605,686608,686610,686634,673104,673305,673309,673522,673527,673586,673620,673655,193222,193223,193224,274206,274207,274301,274304,274406,274802,284126,194101,273155,273163,273301,273302,493554,493558,210427,205265,673637,676123,676303,676305,676306,676508,679329,679330,679574,679575,764047,481661,458667,458775,458883,458888,458990,221603,757037,245206,250402,231210,244303,244402,244412,244413,244601,476444,251203,764073,341303,341503,341506,342902,487221,752024,752065,752081,458116,458336,458468,744202,744204,744205,799260,799270,678581,678642,678683,678688,679103,679104,679306,679309,679336,679502,679513,679533,822121,306302,488333,689501,689551,689584,689585,689615,689676,690504,262122,262201,262501,262522,262530,185101,230204,230304,752109,752113,229206,493111,493114,493225,493661,464551,464661,464886,464993,465661,465667,465669,465679,465680,465683,465693,465697,491881,829130,829131,244922,244924,457114,765025,486111,486114,486226,486450,246171,247121,247231,247662,247669,485775,832402,833216,833219,465001,465337,465447,171201,171213,172024,473660,271831,486661,486771,486890,331024,332301,332402,332404,332709,332713,332715,173101,307001,307027,171102,173202,173204,173206,173207,173208,173209,173215,231205,231207,231208,231216,231219,231223,784177,784180,744105,744107,744206,744211,737128,191101,192121,227409,227809,227813,228118,770032,770038,770039,497220,249001,249145,249155,695526,695551,695562,695574,695602,695607,695608,304021,304022,304804,313205,244712,244717,262401,263151,456224,456443,456665,464228,670721,673576,673577,451111,451113,451115,451224,451660,799035,799153,799205,116019,118898,122026,122032,122033,123414,125046,131002,131038,132021,133003,134126,142601,143804,175120,180121,180133,191001,191002,191003,191004,191005,191006,191007,191008,191009,191010,191011,191012,191013,191014,191015,191016,191017,200101,200102,200742,201101,202389,202390,202391,202393,202394,202396,202411,202421,202721,202722,202723,202724,203133,204001,206016,207502,210100,210105,210801,220016,227107,234005,242005,243406,244003,244711,245412,246700,247445,262404,266005,271404,277011,281402,288005,301101,302103,304020,311003,342646,348220,355063,363646,383004,383009,383354,413019,413270,451659,453777,484002,492021,492075,500609,500867,501539,502320,502779,503004,503501,507102,509223,510510,512200,512501,512503,515802,515804,515809,516297,520307,521035,521169,522419,522505,522602,523325,523502,524449,531053,531208,531212,532002,532003,532004,532313,533457,534212,534213,534214,535350,538101,547211,560101,560114,560122,560149,560157,560203,560204,561224,561230,562203,563155,571183,572110,572144,574149,574157,574164,574299,575219,576244,577166,580102,582614,584166,589301,591001,591002,591003,591004,602087,602088,602089,603603,606306,614604,625418,631505,635635,640613,673608,678570,678603,680322,680609,680771,682317,683107,683504,685518,686028,686674,686721,688544,688545,688546,688547,688548,688549,688550,688554,688563,688564,690550,691018,691588,700404,700408,744127,750014,750122,751000,751054,753027,753141,759031,768150,768205,769017,769031,769034,769037,773235,781068,781133,788012,799055,799252,814117,831107';
		$codarray = explode(',',$allpostcodenotforcod);
		
		
		if(in_array($shippingaddressCollection['postcode'], $codarray)){
				return false;
		}
            return $available;
        }

        $extensionAttributes = $quote->getExtensionAttributes();
        if ($extensionAttributes !== null) {
            $shippingMethods = $extensionAttributes->getShippingAssignments();

            $disallowedShippingMethods = $this->getDisallowedShippingMethods();
            foreach ($shippingMethods as $shippingMethod) {
                if (in_array($shippingMethod->getShipping()->getMethod(), $disallowedShippingMethods)) {
                    $available = false;
                }
                $shippingMethod->getShipping()->getMethod();
            }
        }

        return $available;
    }

    private function disallowSpecificShippingMethods()
    {
        return $this->getConfigData('disallowspecificshippingmethods') === '1';

    }

    private function getDisallowedShippingMethods()
    {
        $disallowedShippingMethods = $this->getConfigData('disallowedshippingmethods');

        return explode(',', $disallowedShippingMethods);
    }
}
